<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> grunt自动化脚本 · Web前端爱好者</title><meta name="description" content="grunt自动化脚本 - SkyCai"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://cnt1992.github.io/atom.xml" title="Web前端爱好者"><meta name="generator" content="Hexo 7.0.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/cnt1992" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><span style="display:none !important;"><span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span></span></span><article class="post-block"><h1 class="post-title">grunt自动化脚本</h1><div class="post-info">2014年11月5日</div><div class="post-content"><p>前端自动化工具<a href="http://gruntjs.cn/getting-started/">Grunt</a>自动化脚本，直接上例子。</p>
<span id="more"></span>

<h3 id="项目根目录下建立三个文件"><a href="#项目根目录下建立三个文件" class="headerlink" title="项目根目录下建立三个文件"></a>项目根目录下建立三个文件</h3><ol>
<li><p>package.json</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;grunt demo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;0.1.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;author&quot;</span>: <span class="string">&quot;sky&quot;</span>,</span><br><span class="line">    <span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;matchdep&quot;</span>: <span class="string">&quot;~0.3.0&quot;</span>,   <span class="comment">//一次执行多次load任务</span></span><br><span class="line">        <span class="string">&quot;grunt&quot;</span>: <span class="string">&quot;~0.4.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-clean&quot;</span>:<span class="string">&quot;*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-concat&quot;</span>: <span class="string">&quot;~0.3.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-uglify&quot;</span>: <span class="string">&quot;~0.2.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-jshint&quot;</span>: <span class="string">&quot;~0.10.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-copy&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-watch&quot;</span>: <span class="string">&quot;~0.4.4&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-htmlmin&quot;</span> : <span class="string">&quot;*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-cssmin&quot;</span>:<span class="string">&quot;*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-imagemin&quot;</span>:<span class="string">&quot;*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;grunt-contrib-connect&quot;</span>:<span class="string">&quot;*&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Gruntfile.js (注释代码看具体项目需要自行修改)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by sky on 2014/11/05</span></span><br><span class="line"><span class="comment"> * 自动化脚本</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">grunt</span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//加载所有grunt任务</span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&#x27;matchdep&#x27;</span>).<span class="title function_">filterDev</span>(<span class="string">&#x27;grunt-*&#x27;</span>).<span class="title function_">forEach</span>(grunt.<span class="property">loadNpmTasks</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册任务</span></span><br><span class="line">    grunt.<span class="title function_">registerTask</span>(<span class="string">&#x27;build&#x27;</span>,<span class="string">&#x27;全自动CSS、JS 压缩 生成文件到build文件夹&#x27;</span>,[<span class="string">&#x27;clean&#x27;</span>,<span class="string">&#x27;uglify:build&#x27;</span>, <span class="string">&#x27;cssmin&#x27;</span>,<span class="string">&#x27;imagemin&#x27;</span>,<span class="string">&#x27;copy&#x27;</span>]);</span><br><span class="line">    grunt.<span class="title function_">registerTask</span>(<span class="string">&#x27;server&#x27;</span>,<span class="string">&#x27;本地创建服务器 及 文件监听&#x27;</span>,[<span class="string">&#x27;connect&#x27;</span>,<span class="string">&#x27;watch&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//参数配置</span></span><br><span class="line">    <span class="keyword">var</span> open = grunt.<span class="title function_">option</span>(<span class="string">&#x27;open&#x27;</span>) || <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置文件信息</span></span><br><span class="line">    <span class="keyword">var</span> cfg = grunt.<span class="property">file</span>.<span class="title function_">readJSON</span>(<span class="string">&#x27;config.json&#x27;</span>),</span><br><span class="line">        serverConf = cfg.<span class="property">server</span>[cfg.<span class="property">server</span>.<span class="property">selected</span>];   <span class="comment">//本地web server信息</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pkg = grunt.<span class="property">file</span>.<span class="title function_">readJSON</span>(<span class="string">&#x27;package.json&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//写入文件头的信息</span></span><br><span class="line">    <span class="keyword">var</span> banner = <span class="string">&#x27;/*\n&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27; * Copyright &lt;%= grunt.template.today(&quot;yyyy&quot;) %&gt;, &lt;%= pkg.author %&gt;\n&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27; *\n&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27; * Released on: &lt;%= grunt.template.today(&quot;yyyy-mm-dd h:MM:ss TT&quot;)  %&gt;  &#x27;</span>+ <span class="string">&#x27;&lt;%= pkg.author %&gt;&#x27;</span> +<span class="string">&#x27;\n&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27;*/\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    grunt.<span class="title function_">initConfig</span>(&#123;</span><br><span class="line">        pkg : pkg,</span><br><span class="line">        <span class="comment">//先清除上一次操作遗留的记录</span></span><br><span class="line">        <span class="attr">clean</span>:&#123;</span><br><span class="line">            <span class="attr">build</span>:[<span class="string">&#x27;./build/&#x27;</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//JS代码校验</span></span><br><span class="line">        <span class="comment">// jshint : &#123;</span></span><br><span class="line">        <span class="comment">//  //更多选项: http://www.jshint.com/docs/options/</span></span><br><span class="line">        <span class="comment">//  options : &#123;</span></span><br><span class="line">        <span class="comment">//      eqeqeq : true,</span></span><br><span class="line">        <span class="comment">//      devel : true,</span></span><br><span class="line">        <span class="comment">//      asi : true, //忽略分号</span></span><br><span class="line">        <span class="comment">//      expr : true,  //支持赋值语句</span></span><br><span class="line">        <span class="comment">//      globals : &#123;</span></span><br><span class="line">        <span class="comment">//          jQuery : true,</span></span><br><span class="line">        <span class="comment">//          console : true</span></span><br><span class="line">        <span class="comment">//      &#125;</span></span><br><span class="line">        <span class="comment">//  &#125;,</span></span><br><span class="line">        <span class="comment">//  build : &#123;</span></span><br><span class="line">        <span class="comment">//      files : &#123;</span></span><br><span class="line">        <span class="comment">//          src : [ &#x27;./js/*&#x27;]</span></span><br><span class="line">        <span class="comment">//      &#125;</span></span><br><span class="line">        <span class="comment">//  &#125;</span></span><br><span class="line">        <span class="comment">// &#125;,</span></span><br><span class="line">        <span class="comment">//JS合并文件</span></span><br><span class="line">        <span class="comment">// concat: &#123;</span></span><br><span class="line">        <span class="comment">//     options: &#123;</span></span><br><span class="line">        <span class="comment">//         //文件内容的分隔符</span></span><br><span class="line">        <span class="comment">//         separator: &#x27;\n&#x27;,</span></span><br><span class="line">        <span class="comment">//         stripBanners: true,</span></span><br><span class="line">        <span class="comment">//         banner: banner</span></span><br><span class="line">        <span class="comment">//     &#125;,</span></span><br><span class="line">        <span class="comment">//     build: &#123;</span></span><br><span class="line">        <span class="comment">//         src: [&#x27;./js/*.js&#x27;],</span></span><br><span class="line">        <span class="comment">//         dest: &#x27;./build/js/script.full.js&#x27;</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">// &#125;,</span></span><br><span class="line">        <span class="comment">//HTML压缩</span></span><br><span class="line">      <span class="comment">//   htmlmin : &#123;</span></span><br><span class="line">      <span class="comment">//    //更多选项：https://github.com/gruntjs/grunt-contrib-htmlmin</span></span><br><span class="line">      <span class="comment">//    options : &#123;</span></span><br><span class="line">      <span class="comment">//        removeComments : true,</span></span><br><span class="line">      <span class="comment">//        collapseWhitespace : true</span></span><br><span class="line">      <span class="comment">//    &#125;,</span></span><br><span class="line">      <span class="comment">//    minify : &#123;</span></span><br><span class="line">            <span class="comment">//  expand : true,</span></span><br><span class="line">            <span class="comment">//  cwd : &#x27;./html/&#x27;,</span></span><br><span class="line">            <span class="comment">//  src : [&#x27;*.html&#x27;],</span></span><br><span class="line">            <span class="comment">//  dest : &#x27;./build/html/&#x27;,</span></span><br><span class="line">            <span class="comment">//  ext : &#x27;.html&#x27;</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">      <span class="comment">//   &#125;,</span></span><br><span class="line">        <span class="comment">//JS压缩</span></span><br><span class="line">        uglify : &#123;</span><br><span class="line">            <span class="comment">//文件头部输出信息</span></span><br><span class="line">            <span class="attr">options</span>: &#123;</span><br><span class="line">                <span class="attr">banner</span>: banner,</span><br><span class="line">                <span class="attr">report</span>: <span class="string">&quot;min&quot;</span><span class="comment">//输出压缩率，可选的值有 false(不输出信息)，gzip</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//具体任务配置</span></span><br><span class="line">            <span class="attr">build</span>:&#123;</span><br><span class="line">                <span class="comment">//用该方法表示只压缩js分别输出到对应文件夹,不合并js</span></span><br><span class="line">                expand : <span class="literal">true</span>,</span><br><span class="line">                cwd : <span class="string">&#x27;./js/&#x27;</span>,</span><br><span class="line">                src : [<span class="string">&#x27;**/*.js&#x27;</span>],</span><br><span class="line">                dest : <span class="string">&#x27;./build/js/&#x27;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//用该方法表示先启动上面js合并再压缩</span></span><br><span class="line">                <span class="comment">// src: [&#x27;&lt;%= concat.build.dest %&gt;&#x27;],</span></span><br><span class="line">                <span class="comment">// dest: &#x27;./build/js/script.js&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//CSS压缩</span></span><br><span class="line">        cssmin : &#123;</span><br><span class="line">            <span class="comment">//文件头部输出信息</span></span><br><span class="line">            options : &#123;</span><br><span class="line">                banner : banner</span><br><span class="line">            &#125;,</span><br><span class="line">            minify : &#123;</span><br><span class="line">                <span class="comment">//用该方法会将所有css合并压缩成一个文件</span></span><br><span class="line">                <span class="comment">// files : &#123;</span></span><br><span class="line">                <span class="comment">//  &#x27;./build/css/style.css&#x27; : [&#x27;./css/*.css&#x27;]</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//用该方法会压缩所有css并且保持每个css独立</span></span><br><span class="line">                expand : <span class="literal">true</span>,</span><br><span class="line">                cwd : <span class="string">&#x27;./css/&#x27;</span>,</span><br><span class="line">                src : [<span class="string">&#x27;*.css&#x27;</span>],</span><br><span class="line">                dest : <span class="string">&#x27;./build/css/&#x27;</span>,</span><br><span class="line">                ext : <span class="string">&#x27;.css&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//图片压缩</span></span><br><span class="line">        imagemin : &#123;</span><br><span class="line">            build : &#123;</span><br><span class="line">                files : [&#123;</span><br><span class="line">                    expand : <span class="literal">true</span>,          <span class="comment">//启动下面选项</span></span><br><span class="line">                    cwd : <span class="string">&#x27;./css/images/&#x27;</span>,</span><br><span class="line">                    src : [<span class="string">&#x27;**/*.&#123;png,jpg,gif&#125;&#x27;</span>],</span><br><span class="line">                    dest : <span class="string">&#x27;./build/css/images/&#x27;</span></span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//将images文件夹copy到build目录下</span></span><br><span class="line">        copy : &#123;</span><br><span class="line">            build : &#123;</span><br><span class="line">                expand : <span class="literal">true</span>,</span><br><span class="line">                cwd : <span class="string">&#x27;./images/&#x27;</span>,</span><br><span class="line">                src : <span class="string">&#x27;**&#x27;</span>,</span><br><span class="line">                dest : <span class="string">&#x27;./build/images/&#x27;</span>,</span><br><span class="line">                filter : <span class="string">&#x27;isFile&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//本机运行一个web server</span></span><br><span class="line">        <span class="attr">connect</span>: &#123;</span><br><span class="line">            <span class="attr">server</span>: &#123;</span><br><span class="line">                <span class="attr">options</span>: &#123;</span><br><span class="line">                    <span class="attr">port</span>: serverConf.<span class="property">port</span>,</span><br><span class="line">                    <span class="attr">hostname</span>: serverConf.<span class="property">host</span>,</span><br><span class="line">                    <span class="attr">base</span>: serverConf.<span class="property">src</span>,</span><br><span class="line">                    <span class="attr">open</span>: open,</span><br><span class="line">                    <span class="attr">livereload</span>:serverConf.<span class="property">livereload</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//监听文件变动</span></span><br><span class="line">        <span class="comment">//改动哪个文件类型 就执行哪个命令 减少多余命令的执行</span></span><br><span class="line">        watch : &#123;</span><br><span class="line">            <span class="comment">//更多选项： http://github.com/gruntjs/grunt-contrib-watch</span></span><br><span class="line">            options : &#123;</span><br><span class="line">                livereload : <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// html : &#123;</span></span><br><span class="line">            <span class="comment">//  files : &#x27;./html/*&#x27;,</span></span><br><span class="line">            <span class="comment">//  tasks : [&#x27;htmlmin&#x27;]</span></span><br><span class="line">            <span class="comment">// &#125;,</span></span><br><span class="line">            <span class="comment">//JS变动</span></span><br><span class="line">            scripts : &#123;</span><br><span class="line">                files : <span class="string">&#x27;./js/*&#x27;</span>,</span><br><span class="line">                tasks : [<span class="string">&#x27;uglify:build&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//CSS变动</span></span><br><span class="line">            css : &#123;</span><br><span class="line">                files : <span class="string">&#x27;./css/*&#x27;</span>,</span><br><span class="line">                tasks : [<span class="string">&#x27;cssmin&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//图片变动</span></span><br><span class="line">            img : &#123;</span><br><span class="line">                files : <span class="string">&#x27;./css/images/*&#x27;</span>,</span><br><span class="line">                tasks : [<span class="string">&#x27;imagemin&#x27;</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">//内容图变动</span></span><br><span class="line">            images : &#123;</span><br><span class="line">                files : <span class="string">&#x27;./images/*&#x27;</span>,</span><br><span class="line">                tasks : [<span class="string">&#x27;copy&#x27;</span>]</span><br><span class="line">            &#125;   </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>config.json (该文件看是否需要启动服务器来监听，若不需要不需配置)</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;server&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;selected&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">        <span class="string">&quot;localhost&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">            <span class="string">&quot;port&quot;</span>: <span class="string">&quot;8081&quot;</span>,</span><br><span class="line">            <span class="string">&quot;livereload&quot;</span>: <span class="string">&quot;35729&quot;</span>,</span><br><span class="line">            <span class="string">&quot;src&quot;</span>: <span class="string">&quot;./&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="运行命令"><a href="#运行命令" class="headerlink" title="运行命令"></a>运行命令</h3><blockquote>
<p>npm install (加载安装相对应的包)</p>
</blockquote>
<blockquote>
<p>grunt build (执行grunt build全自动化命令，在项目根目录下生成build文件夹)</p>
</blockquote>
<blockquote>
<p>grunt server (启动服务器并且监听文件改动)</p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a href="/2014/11/10/koa%E4%B8%8B%E4%B8%80%E4%BB%A3nodejs%E6%A1%86%E6%9E%B6/" class="prev">PREV</a><a href="/2014/10/08/%E5%88%A9%E7%94%A8exif%E8%8E%B7%E5%8F%96%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF/" class="next">NEXT</a></div><div id="gitment_title" onClick="showGitment()" class="gitment_title">显示评论</div><div id="J_commentContainer" style="display:none;"></div><link rel="stylesheet" href="//imsun.github.io/gitment/style/default.css"><script src="//imsun.github.io/gitment/dist/gitment.browser.js"></script><script>const myTheme = {
    render(state, instance) {
        const container = document.createElement('div');
        container.lang = "en-US";
        container.className = 'gitment-container gitment-root-container';
        container.appendChild(instance.renderHeader(state, instance));
        container.appendChild(instance.renderEditor(state, instance));
        container.appendChild(instance.renderComments(state, instance));
        container.appendChild(instance.renderFooter(state, instance));
        return container;
    }
}
function showGitment() {
    document.querySelector('#gitment_title').style.display = 'none';
    document.querySelector('#J_commentContainer').style.display = 'block';
    document.querySelector('#J_commentContainer').classList.add('gitment_container');
    var gitment = new Gitment({
        id: window.location.pathname,
        theme: myTheme,
        owner: 'cnt1992',
        repo: 'cnt1992.github.io',
        oauth: {
            client_id: '09b981847c8a38e58a62',
            client_secret: '1feb91ebe731e68f89af0e6c43928f5f61d0bbf9'
        }
    });
    gitment.render('J_commentContainer');
}</script><div class="copyright"><p>© 2015 - 2024 <a href="https://cnt1992.github.io">SkyCai</a>, Where there is a will there is a way.</p><p style="display:none !important;"><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span><span id="busuanzi_container_site_uv">本站总访客数<span id="busuanzi_value_site_uv"></span>人次</span></p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-75181437-1",'auto');ga('send','pageview');</script><script async="" src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>